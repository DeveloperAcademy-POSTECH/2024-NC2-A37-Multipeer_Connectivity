# 2024-NC2-A37-Multipeer_Connectivity
## ğŸ¥ Youtube Link
(ì¶”í›„ ë§Œë“¤ì–´ì§„ ìœ íŠœë¸Œ ë§í¬ ì¶”ê°€)

## ğŸ’¡ About Multipeer Connectivity

**Multipeer Connectivity** í”„ë ˆì„ì›Œí¬ëŠ” ê·¼ì²˜ ê¸°ê¸°ì—ì„œ ì œê³µë˜ëŠ” ì„œë¹„ìŠ¤ë¥¼ ë°œê²¬í•˜ê³ ,

 ë©”ì‹œì§€ ê¸°ë°˜ ë°ì´í„°, ìŠ¤íŠ¸ë¦¬ë° ë°ì´í„°, ê·¸ë¦¬ê³  íŒŒì¼ê³¼ ê°™ì€ ë¦¬ì†ŒìŠ¤ë¥¼ í†µí•´ í†µì‹ í•˜ëŠ” ì„œë¹„ìŠ¤ ì…ë‹ˆë‹¤.

 - **MCSession**( ì—°ê²°ëœ í”¼ì–´ ì¥ì¹˜ ê°„ì˜ í†µì‹ ê´€ë¦¬ )
 - **MCNearbyServiceAdvertiser**( ì£¼ë³€ì— ìˆëŠ” ë‹¤ë¥¸ ì¥ì¹˜ë“¤ì—ê²Œ ì„¸ì…˜ ì°¸ì—¬ì—¬ë¶€ ì „ë‹¬ )
- **MCAdvertiserAssistant**( ì—°ê²° ìˆ˜ë½ í‘œì¤€ ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ )
- **MCNearbyServiceBrowser**( ì£¼ë³€ ì¥ì¹˜ ê²€ìƒ‰ )
- **MCBrowserViewController**( ì£¼ë³€ í”¼ì–´ë¥¼ ì„ íƒ í‘œì¤€ ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ )
- **MCPeerID**( ê³ ìœ í•˜ê²Œ ì‹ë³„ ì¥ì¹˜ ID )

  
## ğŸ¯ What we focus on?
>  Multipeer Connectivity í”„ë ˆì„ ì›Œí¬ë¥¼ í™œìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì‰½ê²Œ ì „ì†¡í•˜ê³ , MCNearbyServiceAdvertiserì™€ MCNearbyServiceBrowserë¥¼ í™œìš©í•˜ì—¬ ì‚¬ìš©ìë“¤ì´ ì£¼ë³€ì˜ ë‹¤ë¥¸ ì‚¬ìš©ìë¥¼ ì°¾ê³  ì—°ê²°í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. <br/> 

## ğŸ’¼ Use Case
>ë‚´ ìŠ¤ì¼€ì¤„ì„ ì£¼ë³€ ì¹œêµ¬ì˜ ì•±ì— ë„ìš°ê³ , ì•½ì†ì´ ê°€ëŠ¥í•œ ì‹œê°„ì„ ì•± ë‚´ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.<br/> 

## ğŸ–¼ï¸ Prototype
| ìŠ¤ì¼€ì¤„ ì‘ì„± | ìŠ¤ì¼€ì¤„ ê³µìœ  | ê³µìœ  ì•Œë¦¼ | ìŠ¤ì¼€ì¤„ ì¢…í•© | ìŠ¤ì¼€ì¤„ í™•ì • | 
|--|--|--|--|--|
|<img src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A37-Multipeer_Connectivity/assets/88663477/498427fb-eff7-4729-bb32-3eb614bcdcd9" width=200> |<img src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A37-Multipeer_Connectivity/assets/88663477/ff782ee1-52c7-45e5-9b11-8c8b7c86275c" width=200> |<img src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A37-Multipeer_Connectivity/assets/88663477/9a499712-e233-493e-a0ae-c887322ea8d6" width=200>|<img src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A37-Multipeer_Connectivity/assets/88663477/2f663010-6b44-4d62-b724-cba98d874ec6" width=200> |<img src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A37-Multipeer_Connectivity/assets/88663477/6ef77423-1f94-407e-afeb-69ba5b757613" width=200> |

## ğŸ™‹ğŸ»â€â™‚ï¸UserFlow
1. ë‚˜ì˜ ìŠ¤ì¼€ì¤„ì„ ì…ë ¥í•˜ëŠ” ***ìŠ¤ì¼€ì¤„ ì‘ì„±***
2. ë‚˜ì˜ ìŠ¤ì¼€ì¤„ì„ ê³µìœ í•˜ëŠ” ***ìŠ¤ì¼€ì¤„ ê³µìœ ***
3. ì¹œêµ¬ë“¤ì˜ ìŠ¤ì¼€ì¤„ì„ í•œëˆˆì— ëª¨ì•„ë³´ëŠ” ***ìŠ¤ì¼€ì¤„ ì¢…í•©***
4. ì•½ì† ìŠ¤ì¼€ì¤„ì„ ì¼ì‹œë¥¼ í™•ì •í•˜ëŠ” ***ìŠ¤ì¼€ì¤„ í™•ì •***



## ğŸ› ï¸ About Code

### Scheduling View  
#### ì•½ì† ê°€ëŠ¥ ì‹œê°„ ë“œë˜ê¹… ì œìŠ¤ì²˜ í‘œí˜„
```swift

enum TimeDotStyle {
    case none
    case start
    case mid
    case end
    case unavailableStart
    case unavailableMid
    case unavailableEnd
    
    @ViewBuilder
    var style: some View {
        switch self {
        case .none:
            EmptyView()
        case .start:
            VStack {
                Spacer().frame(height: TimeDotManager.spacing)
                UnevenRoundedRectangle(cornerRadii: RectangleCornerRadii(topLeading: 10, topTrailing: 10))
                    .foregroundStyle(AppColor.mint)
            }
        case .mid:
            Rectangle()
                .foregroundStyle(AppColor.mint)
        case .end:
            VStack {
                UnevenRoundedRectangle(cornerRadii: RectangleCornerRadii(bottomLeading: 10, bottomTrailing: 10))
                    .foregroundStyle(AppColor.mint)
                Spacer().frame(height: TimeDotManager.spacing)
            }
        case .unavailableStart:
            VStack {
                UnevenRoundedRectangle(cornerRadii: RectangleCornerRadii(topLeading: 10, topTrailing: 10))
                    .foregroundStyle(.gray.opacity(0.2))
            }
        case .unavailableMid:
            Rectangle()
                .foregroundStyle(.gray.opacity(0.2))
        case .unavailableEnd:
            VStack {
                UnevenRoundedRectangle(cornerRadii: RectangleCornerRadii(bottomLeading: 10, bottomTrailing: 10))
                    .foregroundStyle(.gray.opacity(0.2))
            }
        }
    }
}

 func updatedotStyles(for column: Int) {
        guard let startRow = dragStartRow, let endRow = dragEndRow else { return }
        
        if isErasing {
            for row in min(startRow, endRow)...max(startRow, endRow) {
                dotStyles[row][column] = .none
                feedbackGenerator.impactOccurred(intensity: 0.5)
            }
        } else {
            // Preserve existing rows
            var existingRows: [Int: TimeDotStyle] = [:]
            for row in dotStyles.indices {
                if dotStyles[row][column] != .none {
                    existingRows[row] = dotStyles[row][column]
                }
            }
            
            // Clear current column
            for row in dotStyles.indices {
                dotStyles[row][column] = .none
            }
            
            // Apply existing rows
            for (row, style) in existingRows {
                dotStyles[row][column] = style
            }
            
            // Apply new dragging rows
            for row in min(startRow, endRow)...max(startRow, endRow) {
                if row == min(startRow, endRow) {
                    dotStyles[row][column] = .start
                } else if row == max(startRow, endRow) {
                    dotStyles[row][column] = .end
                } else {
                    dotStyles[row][column] = .mid
                }
            }
            feedbackGenerator.impactOccurred(intensity: 0.5)
        }
        
        // Adjust mid dots if their neighbors are erased
        for row in dotStyles.indices {
            if dotStyles[row][column] == .mid {
                if row > 0 && dotStyles[row - 1][column] != .start && dotStyles[row - 1][column] != .mid {
                    dotStyles[row][column] = .start
                }
                if row < dotStyles.count - 1 && dotStyles[row + 1][column] != .end && dotStyles[row + 1][column] != .mid {
                    dotStyles[row][column] = .end
                }
            }
        }
        
        // Adjust start dots if their neighbors are erased
        for row in dotStyles.indices {
            if dotStyles[row][column] == .start {
                if row < dotStyles.count - 1 && dotStyles[row + 1][column] != .mid && dotStyles[row + 1][column] != .end {
                    dotStyles[row][column] = .none
                }
            }
        }
        
        // Adjust end dots if their neighbors are erased
        for row in dotStyles.indices {
            if dotStyles[row][column] == .end {
                if row > 0 && dotStyles[row - 1][column] != .mid && dotStyles[row - 1][column] != .start {
                    dotStyles[row][column] = .none
                }
            }
        }
    }
```

### MultipeerConnectivity  
#### ë°ì´í„° ì „ì†¡ ë° ì—°ê²° ìƒíƒœ ë³€í™” ê´€ë¦¬
```swift
extension MultipeerConnectivityManager: MCSessionDelegate {
    func session(_ session: MCSession, peer peerID: MCPeerID, didChange state: MCSessionState) {
        DispatchQueue.main.async {
            if state == .connected {
                if !self.peers.contains(peerID) {
                    self.peers.append(peerID)
                }
            } else if state == .notConnected {
                if let index = self.peers.firstIndex(of: peerID) {
                    self.peers.remove(at: index)
                }
            }
        }
    }
    
    func session(_ session: MCSession, didReceive data: Data, fromPeer peerID: MCPeerID) {
        DispatchQueue.main.async {
            self.isReceivingData = true
            self.receivedData = String(data: data, encoding: .utf8)
            self.incomingDataHandler?(data, peerID)
        }
    }
    
    func session(_ session: MCSession, didReceive stream: InputStream, withName streamName: String, fromPeer peerID: MCPeerID) {}
    func session(_ session: MCSession, didStartReceivingResourceWithName resourceName: String, fromPeer peerID: MCPeerID, with progress: Progress) {}
    func session(_ session: MCSession, didFinishReceivingResourceWithName resourceName: String, fromPeer peerID: MCPeerID, at localURL: URL?, withError error: Error?) {}
}

```
